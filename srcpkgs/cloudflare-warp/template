# Template file for 'cloudflare-warp'
pkgname=cloudflare-warp
version=2023.7.40
revision=1
archs="x86_64"
create_wrksrc=yes
short_desc="Cloudflare Warp Client"
maintainer="Mohammad Ebrahimi <moh.ebrahimi2000@gmail.com>"
license="custom:Proprietary"
homepage="https://cloudflarewarp.com"
distfiles="https://pkg.cloudflareclient.com/pool/bookworm/main/c/cloudflare-warp/cloudflare-warp_${version}-1_amd64.deb"
checksum=f4e72c556cb45e4f9b85a1aebe275dc1dc6b292a64dddceea1a4b3e35604cb02
repository="nonfree"
restricted=yes
nostrip=yes

post_extract() {
	$XBPS_FETCH_CMD 'https://www.cloudflare.com/application/terms/' -o cloudflare-terms-of-service.html
}

do_install() {
	vbin bin/warp-cli
	vbin bin/warp-dex
	vbin bin/warp-diag
	vbin bin/warp-svc
	vbin bin/warp-taskbar

	vinstall usr/share/icons/hicolor/scalable/apps/zero-trust-connected.svg 644 \
	usr/share/icons/hicolor/scalable/apps
	vinstall usr/share/icons/hicolor/scalable/apps/zero-trust-disconnected.svg 644 \
	usr/share/icons/hicolor/scalable/apps
	vinstall usr/share/icons/hicolor/scalable/apps/zero-trust-error.svg 644 \
	usr/share/icons/hicolor/scalable/apps
	vinstall usr/share/icons/hicolor/scalable/apps/zero-trust.svg 644 \
	usr/share/icons/hicolor/scalable/apps

	vinstall ${FILESDIR}/com.cloudflare.WarpTaskbar.desktop 644 usr/share/applications

	vlicense cloudflare-terms-of-service.html
	vdoc ${FILESDIR}/README.voidlinux

	vsv warp-svc
}
